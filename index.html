<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Ultimate Screen Recorder Pro</title>
<link rel="icon" href="icon.png" type="image/png">
<style>
    body {
        font-family: Arial, sans-serif;
        background: linear-gradient(135deg, #00ffff, #8e24aa, #ff69b4);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-start;
        min-height: 100vh;
        color: white;
        margin: 0;
        padding-top: 40px;
    }

    h1 {
        margin-bottom: 20px;
        text-shadow: 1px 1px 5px #000;
    }

    .controls {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
        flex-wrap: wrap;
        justify-content: center;
    }

    select, button {
        padding: 10px 16px;
        border: none;
        border-radius: 10px;
        background-color: rgba(0,0,0,0.5);
        color: white;
        font-size: 14px;
        cursor: pointer;
        transition: background 0.3s;
    }

    select:hover, button:hover {
        background-color: rgba(0,0,0,0.7);
    }

    #timer {
        font-size: 24px;
        font-weight: bold;
        text-shadow: 1px 1px 3px #000;
        margin-top: 10px;
    }

    #timer.recording {
        animation: pulse 1s infinite;
    }

    @keyframes pulse {
        0% { text-shadow: 0 0 5px cyan; }
        50% { text-shadow: 0 0 15px cyan; }
        100% { text-shadow: 0 0 5px cyan; }
    }

    video {
        margin-top: 20px;
        max-width: 80%;
        border: 2px solid white;
        border-radius: 10px;
    }

    #downloadBtn {
        padding: 10px 20px;
        margin-top: 10px;
        border: none;
        border-radius: 10px;
        background-color: rgba(0,0,0,0.5);
        color: white;
        font-size: 16px;
        cursor: pointer;
        transition: background 0.3s;
    }

    #downloadBtn:hover {
        background-color: rgba(0,0,0,0.7);
    }
</style>
</head>
<body>
<h1>Ultimate Screen Recorder Pro</h1>

<div class="controls">
    <select id="resolution">
        <option value="1280x720">720p</option>
        <option value="1920x1080" selected>1080p</option>
        <option value="2560x1440">1440p</option>
        <option value="3840x2160">4K</option>
    </select>

    <select id="fps">
        <option value="30">30 FPS</option>
        <option value="60" selected>60 FPS</option>
    </select>

    <button id="start">Start Recording</button>
    <button id="pause" disabled>Pause</button>
    <button id="resume" disabled>Resume</button>
    <button id="stop" disabled>Stop</button>
</div>

<div id="timer">00:00:00</div>
<video id="preview" controls hidden></video>
<button id="downloadBtn" hidden>Download Video</button>

<script>
let mediaRecorder;
let recordedChunks = [];
let timerInterval;
let seconds = 0;
let stream;

function updateTimer() {
    seconds++;
    const h = String(Math.floor(seconds / 3600)).padStart(2,'0');
    const m = String(Math.floor((seconds % 3600)/60)).padStart(2,'0');
    const s = String(seconds % 60).padStart(2,'0');
    document.getElementById('timer').textContent = `${h}:${m}:${s}`;
}

document.getElementById('start').onclick = async () => {
    document.getElementById('start').disabled = true;

    let countdown = 3;
    document.getElementById('timer').textContent = `Starting in ${countdown}...`;
    const countdownInterval = setInterval(() => {
        countdown--;
        if(countdown > 0){
            document.getElementById('timer').textContent = `Starting in ${countdown}...`;
        } else {
            clearInterval(countdownInterval);
            document.getElementById('timer').textContent = '00:00:00';
            startRecording();
        }
    }, 1000);
};

async function startRecording() {
    try {
        const [width, height] = document.getElementById('resolution').value.split('x').map(Number);
        const fps = Number(document.getElementById('fps').value);

        stream = await navigator.mediaDevices.getDisplayMedia({
            video: {
                width: { ideal: width },
                height: { ideal: height },
                frameRate: { ideal: fps, max: fps }
            },
            audio: true
        });

        mediaRecorder = new MediaRecorder(stream, {
            mimeType: 'video/webm;codecs=vp8,opus',
            videoBitsPerSecond: 8000000
        });

        recordedChunks = [];

        mediaRecorder.ondataavailable = e => {
            if(e.data.size > 0) recordedChunks.push(e.data);
        };

        mediaRecorder.onstart = () => {
            timerInterval = setInterval(updateTimer, 1000);
            document.getElementById('timer').classList.add('recording');
            document.getElementById('pause').disabled = false;
            document.getElementById('stop').disabled = false;
        };

        mediaRecorder.onpause = () => {
            clearInterval(timerInterval);
            document.getElementById('timer').classList.remove('recording');
        };

        mediaRecorder.onresume = () => {
            timerInterval = setInterval(updateTimer, 1000);
            document.getElementById('timer').classList.add('recording');
        };

        mediaRecorder.onstop = () => {
            clearInterval(timerInterval);
            seconds = 0;
            document.getElementById('timer').textContent = '00:00:00';
            document.getElementById('timer').classList.remove('recording');

            stream.getTracks().forEach(track => track.stop());

            const blob = new Blob(recordedChunks, { type: 'video/webm' });
            const url = URL.createObjectURL(blob);

            const preview = document.getElementById('preview');
            preview.pause();
            preview.src = url;
            preview.load();
            preview.hidden = false;
            preview.play();

            const downloadBtn = document.getElementById('downloadBtn');
            downloadBtn.hidden = false;
            downloadBtn.onclick = () => {
                const a = document.createElement('a');
                a.href = url;
                a.download = 'recording.webm';
                a.click();
            };

            document.getElementById('pause').disabled = true;
            document.getElementById('resume').disabled = true;
            document.getElementById('stop').disabled = true;
            document.getElementById('start').disabled = false;
        };

        mediaRecorder.start(100);

    } catch(err) {
        alert("Recording failed: " + err);
        document.getElementById('start').disabled = false;
    }
}

document.getElementById('pause').onclick = () => {
    if(mediaRecorder && mediaRecorder.state === "recording"){
        mediaRecorder.pause();
        document.getElementById('pause').disabled = true;
        document.getElementById('resume').disabled = false;
    }
};

document.getElementById('resume').onclick = () => {
    if(mediaRecorder && mediaRecorder.state === "paused"){
        mediaRecorder.resume();
        document.getElementById('pause').disabled = false;
        document.getElementById('resume').disabled = true;
    }
};

document.getElementById('stop').onclick = () => {
    if(mediaRecorder && mediaRecorder.state !== "inactive") mediaRecorder.stop();
};
</script>
</body>
</html>
